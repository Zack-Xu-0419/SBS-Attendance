(function(e){function t(t){for(var a,i,o=t[0],u=t[1],d=t[2],l=0,g=[];l<o.length;l++)i=o[l],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&g.push(s[i][0]),s[i]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);c&&c(t);while(g.length)g.shift()();return r.push.apply(r,d||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var u=n[o];0!==s[u]&&(a=!1)}a&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},s={app:0},r=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=u;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"04c0":function(e,t,n){},1:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("StudentList")],1)},r=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"StudentList"},[a("img",{attrs:{alt:"SBS Attendance",id:"SBS_logo",src:n("cf05")}}),""!=e.image?a("img",{attrs:{src:e.image,alt:"User image",id:"user_image"}}):e._e(),a("google-signin-btn",{attrs:{label:e.isSignedIn,"custom-class":"signinButton"},on:{click:e.signIn}}),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],attrs:{type:"text",id:"searchBox",placeholder:"Student name or ID",autofocus:""},domProps:{value:e.search},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.enter(e.filteredStudents)},input:function(t){t.target.composing||(e.search=t.target.value)}}}),a("label",{attrs:{for:"event"}},[e._v("Event type:")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.event,expression:"event"}],attrs:{id:"event"},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.event=t.target.multiple?n:n[0]}}},[a("option",{attrs:{value:"AB"}},[e._v("1")]),a("option",{attrs:{value:"CD"}},[e._v("2")]),a("option",{attrs:{value:"EF"}},[e._v("3")]),a("option",{attrs:{value:"GH"}},[e._v("4")]),a("option",{attrs:{value:"IJ"}},[e._v("5")])]),a("label",{attrs:{for:"grade"}},[e._v("Student grade:")]),a("select",{directives:[{name:"model",rawName:"v-model",value:e.grade,expression:"grade"}],attrs:{id:"grade",disabled:"Sign In"==e.isSignedIn},on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.grade=t.target.multiple?n:n[0]},e.setData]}},[a("option",{attrs:{value:"",disabled:""}},[e._v("Please select:")]),a("option",{attrs:{value:"7"}},[e._v("7th Grade")]),a("option",{attrs:{value:"8"}},[e._v("8th Grade")]),a("option",{attrs:{value:"9"}},[e._v("9th Grade")]),a("option",{attrs:{value:"10"}},[e._v("10th Grade")]),a("option",{attrs:{value:"11"}},[e._v("11th Grade")]),a("option",{attrs:{value:"12"}},[e._v("12th Grade")])]),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.gender,expression:"gender"}],attrs:{type:"radio",name:"gender",id:"all",value:"",checked:"",disabled:"Sign In"==e.isSignedIn},domProps:{checked:e._q(e.gender,"")},on:{change:function(t){e.gender=""}}}),a("label",{attrs:{for:"all"}},[e._v("All students")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.gender,expression:"gender"}],attrs:{type:"radio",name:"gender",id:"male",value:"Male",disabled:"Sign In"==e.isSignedIn},domProps:{checked:e._q(e.gender,"Male")},on:{change:function(t){e.gender="Male"}}}),a("label",{attrs:{for:"male"}},[e._v("Boys")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.gender,expression:"gender"}],attrs:{type:"radio",name:"gender",id:"female",value:"Female",disabled:"Sign In"==e.isSignedIn},domProps:{checked:e._q(e.gender,"Female")},on:{change:function(t){e.gender="Female"}}}),a("label",{attrs:{for:"female"}},[e._v("Girls")])])]),e.students&&e.students.length&&"Sign Out"==e.isSignedIn?a("button",{attrs:{type:"submit",id:"submitButton"},on:{click:e.submit}},[e._v("Submit")]):e._e(),e.students&&e.students.length&&"Sign Out"==e.isSignedIn?a("div",{attrs:{id:"remainingStudents"}},e._l(e.filteredStudents,(function(t,n){return a("div",{key:n,staticClass:"students",on:{click:function(n){return e.attended(t)}}},[a("img",{staticClass:"student_image",attrs:{src:"https://bbk12e1-cdn.myschoolcdn.com/ftpimages/935/user/"+t.large_filename,alt:t.name}}),a("span",{staticClass:"student_name"},[e._v(e._s(t.name))])])})),0):e._e(),e.students&&e.students.length&&"Sign Out"==e.isSignedIn?a("div",{attrs:{id:"checkedStudents"}},e._l(e.checkedStudents,(function(t,n){return a("div",{key:n,staticClass:"students",on:{click:function(n){return e.undo(t)}}},[a("img",{staticClass:"student_image",attrs:{src:"https://bbk12e1-cdn.myschoolcdn.com/ftpimages/935/user/"+t.large_filename,alt:t.name}}),a("span",{staticClass:"student_name"},[e._v(e._s(t.name))])])})),0):e._e()],1)},o=[],u=(n("99af"),n("4de4"),n("4160"),n("c975"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("466d"),n("4d90"),n("5319"),n("841c"),n("159b"),n("ddb0"),n("8055")),d=n.n(u),c={name:"StudentList",data:function(){return{isSignedIn:"",search:"",gender:"",grade:"",image:"",students:[],event:"AB"}},methods:{signIn:function(){var e=this;this.$gapi.isSignedIn().then((function(t){t?e.$gapi.signOut().then((function(){alert("User signed out."),e.image="",e.isSignedIn="Sign In"})):e.$gapi.signIn().then((function(t){alert("Signed in as "+t.name+"."),e.image=t.image,e.isSignedIn="Sign Out",e.getData().then((function(t){localStorage.getItem("students")&&localStorage.getItem("students")!=JSON.stringify(t)&&confirm("You have attendace that is not saved. Do you want to continue taking the previous attendance?")?e.students=JSON.parse(localStorage.students):""!=e.grade&&(e.students=t)}))})).catch((function(e){alert("Error: "+e.error+".")}))})),document.getElementById("searchBox").focus()},convertJSON:function(e){for(var t=[],n=e[0],a=1;a<e.length;a++){for(var s={},r=e[a],i=0;i<n.length;i++)s[n[i].replace(/( |-)/g,"_").toLowerCase()]=r[i];""==s.nickname?s.name=s.first_name+" "+s.last_name:s.name=s.nickname+" "+s.last_name,s.isPresent=!1,s.presentTime="",["user_id","first_name","last_name","thumb_filename","role","e_mail","nickname"].forEach((function(e){return delete s[e]})),t.push(s)}return t},getData:function(){var e=this;return this.$gapi.request({path:"https://sheets.googleapis.com/v4/spreadsheets/1TQjA6ZdRGgQpH2phhl3Mz1HaM8nQQ8YoKQJLCuPqoGs/values/Sheet1",method:"GET"}).then((function(t){var n,a=new Date,s=a.getFullYear(),r=a.getMonth();switch(r>=7&&s++,e.grade){case"7":n=(s+5).toString();break;case"8":n=(s+4).toString();break;case"9":n=(s+3).toString();break;case"10":n=(s+2).toString();break;case"11":n=(s+1).toString();break;case"12":n=s.toString();break}return e.convertJSON(t.result.values).filter((function(e){return e.grad_year==n}))}),(function(e){alert("Error: "+e.result.error.message)}))},setData:function(){var e=this;this.getData().then((function(t){e.students=t}))},getTime:function(){var e=new Date,t=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0"),a=String(e.getSeconds()).padStart(2,"0");return e=t+":"+n+":"+a,e},attended:function(e){this.students[this.students.indexOf(e)].isPresent=!0,this.students[this.students.indexOf(e)].presentTime=this.getTime(),this.update()},enter:function(e){e[0]&&(this.students[this.students.indexOf(e[0])].isPresent=!0,this.students[this.students.indexOf(e[0])].presentTime=this.getTime()),this.search="",this.update()},undo:function(e){this.students[this.students.indexOf(e)].isPresent=!1,this.students[this.students.indexOf(e)].presentTime="",this.update()},update:function(){localStorage.setItem("students",JSON.stringify(this.students)),this.socket.emit("student-update",{grade:this.grade,event:this.event,students:this.students})},writeData:function(e,t){var n=this;this.$gapi.request({path:"https://sheets.googleapis.com/v4/spreadsheets/1hf-s8uJXXTP_-XsXm8PtRQhsks48a-CWGtlEtroIzm4/values/".concat(this.grade,"th-Grade!").concat(this.event[0],":").concat(this.event[0],"?valueInputOption=RAW"),method:"PUT",body:{range:"".concat(this.grade,"th-Grade!").concat(this.event[0],":").concat(this.event[0]),majorDimension:"ROWS",values:e}}).then((function(){n.$gapi.request({path:"https://sheets.googleapis.com/v4/spreadsheets/1hf-s8uJXXTP_-XsXm8PtRQhsks48a-CWGtlEtroIzm4/values:batchUpdate",method:"POST",body:{valueInputOption:"RAW",data:t}})})).then((function(){alert("Submitted successfully.")})).catch((function(e){alert("Error: "+e.result.error.message)}))},submit:function(){var e=this,t=new Date,n=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),s=t.getFullYear();t=a+"/"+n+"/"+s;var r=[[t]];this.students.forEach((function(e){r.push([e.name])}));var i=[{range:"".concat(this.grade,"th-Grade!").concat(this.event[1],"1"),majorDimension:"ROWS",values:[[(this.event[0].toLowerCase().charCodeAt(0)-97)/2+1]]}];this.students.forEach((function(t){t.isPresent&&i.push({range:"".concat(e.grade,"th-Grade!").concat(e.event[1]).concat(e.students.indexOf(t)+2),majorDimension:"ROWS",values:[[t.presentTime]]})})),confirm("Are you sure that you want to submit attendance for ".concat(this.grade,"th grade?"))&&this.$gapi.request({path:"https://sheets.googleapis.com/v4/spreadsheets/1hf-s8uJXXTP_-XsXm8PtRQhsks48a-CWGtlEtroIzm4/values/".concat(this.grade,"th-Grade"),method:"GET"}).then((function(n){var a=e.event[0].toLowerCase().charCodeAt(0)-97;void 0==n.result.values||n.result.values[0][a]!=t?e.$gapi.request({path:"https://sheets.googleapis.com/v4/spreadsheets/1hf-s8uJXXTP_-XsXm8PtRQhsks48a-CWGtlEtroIzm4/values/".concat(e.grade,"th-Grade!").concat(e.event[1],":").concat(e.event[1],":clear"),method:"POST"}).then(e.writeData(r,i)).catch((function(e){alert("Error: "+e.result.error.message)})):e.writeData(r,i)}),(function(e){alert("Error: "+e.result.error.message)})),this.setData(),this.update()}},computed:{filteredStudents:function(){var e=this;return this.students.filter((function(t){return(t.name.toLowerCase().match(e.search.toLowerCase())||t.student_id.match(e.search))&&t.gender.match(e.gender)&&0==t.isPresent}))},checkedStudents:function(){var e=this;return this.students.filter((function(t){return t.gender.match(e.gender)&&1==t.isPresent}))}},mounted:function(){var e=this;window.addEventListener("beforeunload",(function(e){e.preventDefault(),e.returnValue=""})),this.socket=d()(),this.socket.on("student-update",(function(t){t.grade==e.grade&&t.event==e.event&&(e.students=t.students,localStorage.setItem("students",JSON.stringify(e.students)))})),this.grade=localStorage.getItem("grade")||"",this.gender=localStorage.getItem("gender")||"",this.event=localStorage.getItem("event")||"AB";var t=document.getElementById("searchBox"),n=document.getElementById("all"),a=document.getElementById("male"),s=document.getElementById("female"),r=document.getElementById("grade");function i(){t.focus()}n.addEventListener("change",i,!1),a.addEventListener("change",i,!1),s.addEventListener("change",i,!1),r.addEventListener("change",i,!1),this.$gapi.isSignedIn().then((function(t){e.isSignedIn=t?"Sign Out":"Sign In"}))},watch:{grade:function(e){localStorage.setItem("grade",e)},gender:function(e){localStorage.setItem("gender",e)},event:function(e){localStorage.setItem("event",e)}}},l=c,g=(n("894f"),n("2877")),h=Object(g["a"])(l,i,o,!1,null,"26ba3da2",null),m=h.exports,p={name:"App",components:{StudentList:m}},v=p,f=Object(g["a"])(v,s,r,!1,null,null,null),S=f.exports,_=n("485e"),b={apiKey:"AIzaSyDt2VxRLzdi8qL2Tl_SVTlOV5XVhTvTt94",clientId:"954999908134-m0bcfcjvukvlbh6hosk4uj8mhqfm7p3o.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/spreadsheets",discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"]};a["a"].use(_["a"],b),a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(S)}}).$mount("#app")},"894f":function(e,t,n){"use strict";var a=n("04c0"),s=n.n(a);s.a},cf05:function(e,t,n){e.exports=n.p+"img/logo.3006d8ff.png"}});
//# sourceMappingURL=app.e955f327.js.map